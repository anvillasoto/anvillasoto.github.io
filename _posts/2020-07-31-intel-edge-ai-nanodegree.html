---
layout: post
title: "IntelÂ® Edge AI for IoT Developers"
subtitle: "My journey towards finishing this scholarship from Udacity"
date: 2020-07-31 03:36:00 +0800
background: '/img/posts/2020-07-31-intel-edge-ai-nanodegree/cover.jpg'
---

<p style="text-align: justify;">On April 1, 2019, I received an email from Udacity telling me that I won a scholarship and the message reads something like this:</p>
<blockquote>Congratulations! We're very happy to offer you a Nanodegree program in the <strong>Intel &reg; Edge AI Scholarship</strong>. Out of thousand of students in the Scholarship OpenVINO Foundational Course, your progress in the course and dedication in the community really stood out. We&rsquo;ve been impressed and we&rsquo;re excited for you to continue the journey!</blockquote>
<p style="text-align: justify;">Actually, that is true. Out of about 11,000 participants I managed to be in one of 750 scholarship awardees for the brand new Intel&reg;&nbsp;Edge&nbsp;AI&nbsp;for&nbsp;IoT&nbsp;Developers Nanodegree. And guess what? I also got a badge!</p>
<p style="text-align: justify;"><br /> <img style="display: block; margin-left: auto; margin-right: auto;" src="https://anvillasoto.github.io/img/posts/2020-07-31-intel-edge-ai-nanodegree/scholarship_badge.jpg" alt="Scholarship Badge" width="500" height="500" /> <br /> To be honest with you, this is not the first time that I got a scholarship from Udacity. I was also part of Secure and Private AI scholarship&nbsp; from Facebook and Bertelsmann Technology Scholarship, to which I earned Deep Learning and Cloud Devops Engineer Nanodegree seats respectively. In this article, I want to share my experience working on the three projects and how I managed to graduate near the program deadline (the day of this writing).</p>
<h3>Program Background</h3>
<p style="text-align: justify;">The data science or machine learning projects prioritizes modeling and deployment of applications as part of their end-to-end process. A lot of times, machine learning application deployment needs a lot of compute resources in order for them to be accessed by stakeholders. Not to mention the cost of modeling which may need advanced compute environments with high powered CPUs and GPUs. And what if the project must be deployed in a site with limited to no connectivity but expects to deliver high accuracy and performance with real-time processing requirements? What if the organization has sensitive information that neededs to be processed but cannot risk running them to cloud for privacy reasons? This is where local processing or <em>processing on the</em>&nbsp;<strong>edge</strong>&nbsp;is important compare to running it the application in the cloud which can be problematic for scenarios mentioned above. If processing can be done in-device, needing connectivity to the cloud is unnecessary which will address issues of latency and privacy. Enter Intel &reg; OpenVINO. With this tool, we leverage pre-trained models available in the Intel &reg; Distribution of OpenVINO Toolkit&trade;, convert and optimize other models with their own implementation of Model Optimizer, and perform inference with their implementation of the Inference Engine.</p>
<h3>My Experience</h3>
<h4>Edge AI Fundamentals with OpenVINO&trade;</h4>
<p style="text-align: justify;">For the first part of the course, Instructor Michael Virgo introduces AI at the edge and how&nbsp;OpenVINO Toolkit&trade; can be used to interesting edge AI projects like handling video streams and building a web application with MQTT communication layer. In the course, I learned about the parts that make up the toolkit like the wide array of pre-trained models that are directly available for use within the OpenVINO toolkit, the Model Optimizer that allows users to take models trained from industry-standard machine learning frameworks like TensorFlow, ONNX, Caffe, MXNet, and Kaldi with ONNX being able to suppport&nbsp; other frameworks such as PyTorch and CNTK, perform inference using the Inference Engine and finally, simulating a real-time application by using the&nbsp; model that is already in the Intermediate Representation (meaning it can be used by the inference engine for inference) to deploy an edge application.</p>
<p style="text-align: justify;">That being said, the first project is&nbsp;<strong><em>Deploy a People Counter App at the Edge</em>.</strong>&nbsp;Basically, the project requires the student to leverage pre-trained models from different industry-standard machine learning frameworks to detect persons per frame and create a logic that coounts the number of people going in and out of the frame.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="https://anvillasoto.github.io/img/posts/2020-07-31-intel-edge-ai-nanodegree/people-counter-image.png" alt="people-counter-image" width="600" height="308" /></p>
<p style="text-align: justify;">The first project is a little bit challenging in that, you need to explore pre-trained models to detect persons in the frame and devise a logic that would count them correctly since OpenVINO spits out predictions on a per-frame basis. Apart from it being challenging, it is rewarding at the same time because this simulates what to expect as an IoT engineer. And to add to the excitement, the app can be run on the local machine via webcam and you can actually see it counting people in action, changing values in the dashboard real-time.&nbsp;</p>
<h4>Choosing the Right Hardware</h4>
<p style="text-align: justify;">The second part of the course delves deeper into the process of creating machine learning-enabled edge application. A lot of times, developers only concerns themselves to the implementation of the application to make, without realizing that there are several constraints that must be taken care of like cost of hardware, electrical consumption and the power that you may get from acquiring the hardware. It is through these combinations you will be able to realize an application that, not only solves the problem at hand but also considers what the stakeholders require. That being said, Intel devised a framework that would enable seamless collaboration between data scientists, IoT engineers and stakeholders in designing and deploying and edge AI system:</p>
<p style="text-align: center;"><img src="https://anvillasoto.github.io/img/posts/2020-07-31-intel-edge-ai-nanodegree/edge-ai-development-cycle.png" alt="edge ai-development-cycle" width="600" height="281" /></p>
<p style="text-align: justify;">Aside from the design, this lesson also gives an overview of compatible hardware offered by Intel from CPUs, Integrated GPUs, Visual Processing Units (VPUs) and Field-Programmable Gate Arrays (FPGAs), comparing the pros and cons between them. Finally, this chapter includes an introduction to Intel DevCloud, a cloud service that lets you benchmark the performance of each hardware and their combinations without actually having to acquire each of them.</p>
<p style="text-align: justify;">For this module's project entitled <strong><em>Smart Queuing System</em></strong>, they are more of a case study albeit it also builds on top of the first project. Students are tasked to complete the Python and job submission scripts to communicate with the DevCloud right within the Udacity workspace. Students must be able to assess requirements from each of the scenarios given (manufacturing, retail and transportation) and be able to recommend hardware solutions based on the constraints of price, power and performance.&nbsp;</p>
<p style="text-align: center;"><img src="http://anvillasoto.github.io/img/posts/2020-07-31-intel-edge-ai-nanodegree/smart-queuing-system.gif" alt="smart-queuing-system" width="600" height="338" /></p>
<p style="text-align: justify;">This project gleans towards the expected career of an IoT engineer in my opinion. To be able to extract meaningful information from clients, test combinations of hardware solutions that fits and deliver an application using the selected&nbsp; hardware solution.</p>
<h4>Optimization Techniques and Tools</h4>
<p style="text-align: justify;">Many appliications, like I said before needs to process real-time data streams from myriad of sensors. And since we solved the majority of latency problems by running the model and inference in-device without needing external cloud solution, one aspect of how we can still improve the performance of the overall application is through software optimization. And this is what the final lesson is all about, optimizing models by (1) reducing model operations through removing network nodes or turning them off altogether, (2) reducing model size by replacing dense layers and convolutions with specialized layers and (3) using VTune amplifier to drill down to the performance of the application and find hotspots for bottlenecks.</p>
<p style="text-align: justify;">The final project, <strong><em>Computer Pointer Controller</em></strong> is perhaps the most challenging of all projects. Basically, the task is to use multiple object detection and recognition models from Intel Pretrained Models and Intel hardware to create an application that controls mouse pointer aided only by gaze. Controlling the mouse using only your gaze? Amazing right?</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="https://anvillasoto.github.io/img/posts/2020-07-31-intel-edge-ai-nanodegree/computer-pointer-controller.gif" alt="computer-pointer-controller.gif" width="600" height="338" /></p>
<p style="text-align: justify;">In this project, I managed to controll the mouse using pyautogui package from Python and get the coordinates to which the mouse pointer is heading with the use of four models from Intel Model Zoo - (1) face detection, (2) landmark detection to detect eyes, (3) head pose detection to detect head orientation and (4) gaze detection to determine which direction does face in the camera feed is gazing. I also learned on how to toggle each of the bounding boxes on and off depending on user's preference.&nbsp;</p>
<p style="text-align: justify;">To review, this project is worthy of the course's culmination. It is challenging, yes&nbsp; but the course materials really helped you getting up&nbsp; to speed on how to create virtual environments, provide detailed documentation, use multiple sources of inputs, implement inference data pipeline in a real time fashion, visualize outputs as needed and make use of the available Intel hardware to run the application locally.</p>
<h3>Conclusion</h3>
<p style="text-align: center;"><img src="https://anvillasoto.github.io/img/posts/2020-07-31-intel-edge-ai-nanodegree/certificate.PNG" alt="certificate" width="600" height="465" /></p>
<p style="text-align: justify;">I am incredibly proud to be one of 750 lucky scholarship awardees of this amazing nanodegree. I have here my projects uploaded in my GitHub- <a title="Deploy a People Counter App at the Edge" href="https://github.com/anvillasoto/people-counter-edge-application" target="_blank" rel="noopener"><strong><em>Deploy a People Counter App at the Edge</em></strong></a><em>,&nbsp;</em><a title="Smart Queuing System" href="https://github.com/anvillasoto/smart-queuing-system" target="_blank" rel="noopener"><strong><em>Smart Queuing System</em></strong></a><em> and&nbsp;</em><a title="Computer Pointer Controller" href="https://github.com/anvillasoto/computer-pointer-controller" target="_blank" rel="noopener"><strong><em>Computer Pointer Controller</em></strong></a>. This is definitely not the end of my journey exploring OpenVINO let alone Internet of Things. Stay tuned for more.</p>
<p>Since this is the first time that I make a blog setting up the whole thing, you probably want to know how I managed to get three scholarships from Udacity. I am excited to tell my&nbsp; story in the upcoming days.</p>